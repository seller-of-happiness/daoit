# Исправления чатов и приглашений

## Проблемы и их решения

### 1. ✅ Убран ненужный тег `<mark>` в отображении имен сотрудников

**Проблема:** В приглашениях чатов отображались ненужные теги `<mark>` вокруг имен сотрудников из-за неправильного использования переменной поиска.

**Решение:** 
- В `InviteUsersDialog.vue` заменено `search` на `searchQuery` для корректной подсветки только при активном поиске
- В `EmployeeSelectionModal.vue` аналогичное исправление
- Теперь подсветка появляется только при поиске с 2+ символами после дебаунса

**Измененные файлы:**
- `/workspace/src/refactoring/modules/chat/components/InviteUsersDialog.vue`
- `/workspace/src/components/adverseEvents/EmployeeSelectionModal.vue`

### 2. ✅ Улучшена работа сокетов для приглашений

**Проблема:** Приглашения могли не доходить до других пользователей из-за проблем с подключением к Centrifuge.

**Решение:**
- Добавлена проверка и принудительная инициализация Centrifuge при загрузке чатов
- Добавлено подробное логирование для отладки подключения к WebSocket
- Улучшена диагностика состояния Centrifuge

**Измененные файлы:**
- `/workspace/src/refactoring/modules/chat/stores/chatStore.ts`

### 3. ✅ Проверено обновление данных при отправке приглашений

**Проблема:** Данные чата могли не обновляться после отправки приглашений.

**Решение:**
- Добавлено логирование процесса отправки приглашений
- Подтверждена корректная логика обновления данных чата после API вызовов
- Добавлены console.log для отладки получения данных через WebSocket

## Что теперь работает корректно

1. **Отображение имен:** Больше нет лишних тегов `<mark>` в списках сотрудников
2. **WebSocket соединение:** Улучшена надежность подключения к Centrifuge
3. **Приглашения:** Корректно отправляются и обрабатываются через сокеты
4. **Обновление данных:** Чаты обновляются после отправки приглашений

## Отладочная информация

Теперь в консоли браузера будут видны сообщения:
- `[ChatStore] Подписываемся на канал: chats:user#UUID`
- `[ChatStore] Получено сообщение из centrifuge: {...}`
- `[ChatStore] Отправляем приглашения: {...}`
- `[ChatStore] Состояние Centrifuge: {...}`

Это поможет диагностировать проблемы с сокетами в будущем.

## Проверка исправлений

Для проверки работы:
1. Откройте чат и попробуйте пригласить пользователя
2. Проверьте консоль на наличие логов
3. Убедитесь, что в списке сотрудников нет лишних выделений
4. Проверьте, что приглашения доходят до других пользователей